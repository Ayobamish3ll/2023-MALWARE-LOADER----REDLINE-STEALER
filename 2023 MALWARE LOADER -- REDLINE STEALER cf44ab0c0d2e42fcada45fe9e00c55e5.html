<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>2023 MALWARE LOADER --&gt; REDLINE STEALER</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="cf44ab0c-0d2e-42fc-ada4-5fe9e00c55e5" class="page sans"><header><h1 class="page-title"><strong>2023 MALWARE LOADER --&gt; REDLINE STEALER</strong></h1><p class="page-description"></p></header><div class="page-body"><h3 id="a85e3371-86d5-40ac-ac66-bdc6eaba36ef" class="">Executive Summary</h3><p id="e918ac0d-bbb3-4bf4-b17f-6ffa0e292bbe" class="">RedLine Stealer is information-stealing malware that harvests login credentials and other sensitive data from a victim&#x27;s Windows host. A system inventory is also taken when running on a target machine, to include details such as the username, location data, hardware configuration, and information regarding installed security software. More recent versions of RedLine added the ability to steal cryptocurrency. FTP and IM clients are also apparently targeted by this family, and this malware has the ability to upload and download files, execute commands, and periodically send back information about the infected computer.</p><h3 id="cd5afd7b-351f-4588-943e-6bd8c2a117c3" class="">Objective</h3><ul id="32056b91-762a-4492-a921-aac24fdace77" class="bulleted-list"><li style="list-style-type:disc"><strong>Primary Goal:</strong> Analyse network traffic to identify and investigate anomalies, potential security threats, and performance issues hereby giving answer to the questions asked below:<ul id="9f2a77d1-154e-41d4-b84f-6fa4e3a9afe6" class="bulleted-list"><li style="list-style-type:circle">What is the date and time in UTC the infection started?</li></ul><ul id="5f8b9374-412f-4620-bce9-9f19158b5038" class="bulleted-list"><li style="list-style-type:circle">What is the IP address of the infected Windows client?</li></ul><ul id="5b2e260c-96c6-4a9c-9d6f-95f0b6c1a499" class="bulleted-list"><li style="list-style-type:circle">What is the MAC address of the infected Windows client?</li></ul><ul id="d53fe9ae-d0e5-486e-a187-006543e5d5ab" class="bulleted-list"><li style="list-style-type:circle">What is the hostname of the infected Windows client?</li></ul><ul id="8b9a7c53-a8fb-4a52-899a-479dc85f4894" class="bulleted-list"><li style="list-style-type:circle">What is the user account name from the infected Windows host?</li></ul><ul id="b80fada7-6f83-4bb2-bf6c-73f8d7cdff03" class="bulleted-list"><li style="list-style-type:circle">What type of information did this RedLine Stealer try to steal?</li></ul></li></ul><ul id="f55f7a29-623c-4cc1-8577-c84ef3a6492e" class="bulleted-list"><li style="list-style-type:disc"><strong>Secondary Goals:</strong> Gain insights into network usage patterns and detect any unauthorised activities such as data exfiltration.</li></ul><p id="1168a6c0-9701-445a-b6df-54958e14e90e" class="">Importing the pcap data into Wireshark, we are presented by the content of the pcap including the total number of packets (2,497) as shown in Figure 1. </p><figure id="baebda0e-2b5e-42af-b09b-f7c3ab72ebd5" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled.png"><img style="width:1912px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled.png"/></a><figcaption><em>Figure 1 - Content of Pcap</em></figcaption></figure><p id="5f7d5e75-33c7-4767-8286-d1bae460dcfb" class="">To better understand the packet and the related conversation packets, we can begin by using the &quot;Statistics: Protocol Hierarchy&quot; bar as shown in Figure 2.</p><figure id="cc827573-99cc-4b2c-8f6b-a20786d3d237" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/f8dec33b-c598-4d1c-a2d8-8134c1980bd4.png"><img style="width:708px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/f8dec33b-c598-4d1c-a2d8-8134c1980bd4.png"/></a></figure><figure id="28a992f6-ea37-4b6a-8805-43dc43178e61" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%201.png"><img style="width:1526px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%201.png"/></a><figcaption><em>Figure 2 </em></figcaption></figure><p id="a5cf6846-d834-4284-b0b7-3ce251bcb8bb" class="">We observe several protocols, including NBNS, SMB, DNS, MDNS, Kerberos, and many others, which will be utilized during the analysis of this pcap data. </p><p id="f51c57f7-9269-4145-b1c7-21cee782fa29" class="">As shown in Figure 4 below, applying the basic web filter reveals a single internal IP address, 10.7.10.47, as the sole source IP address. Using the frame data, we can associate this source IP with the MAC address 80:86:5b:ab:1e:c4.</p><figure id="9aaeb01a-04aa-420c-85f4-cdab7bd8400d" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%202.png"><img style="width:1898px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%202.png"/></a><figcaption><em>Figure 4 - showing IP address and MAC address</em></figcaption></figure><p id="bf006424-5a3b-4b31-9e43-b896a815f870" class="">We can identify the victim’s hostname by filtering either NetBIOS Name Service (NBNS) or Server Message Block (SMB) traffic. Apply the Wireshark filter <code>nbns</code> to find DESKTOP-9PEA63H, as illustrated in Figure 5a and 5b below.</p><figure id="1d4bea64-e488-4f8a-b548-5bd337c490d1" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%203.png"><img style="width:1912px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%203.png"/></a><figcaption><em>Figure 5a - Using SMB as a filter to get the  victim’s hostname.</em></figcaption></figure><figure id="cd05766a-eda0-40b3-b5ff-5c61d67035eb" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%204.png"><img style="width:1912px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%204.png"/></a><figcaption><em>Figure 5b - Using NBNS as a filter to get the victim’s hostname.</em></figcaption></figure><p id="26a2466f-66d4-4373-a1e6-7211938a8789" class="">We can further confirm the victim’s hostname and Windows user account name through Kerberos authentication traffic, such as AS-REQ and AS-REP. By filtering on <code>kerberos.CNameString</code>, we can find the Windows user account name <em><code><span style="border-bottom:0.05em solid">rwalters</span></code></em>, as demonstrated in Figure 6 below.</p><figure id="e2928b2c-ffef-482f-9754-67e5f1729b7d" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%205.png"><img style="width:1910px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%205.png"/></a><figcaption><em>Figure 6 - determining the user account name through Kerberos authentication traffic.</em></figcaption></figure><p id="2635ff6e-bae9-4bb7-a1d7-91b96643b9c5" class="">To further investigate this packet for signs of data exfiltration, we can revisit the basic HTTP filter to examine the three GET requests identified in the packet.</p><figure id="cb0caee7-11e0-4a4a-8496-8e7ef3d06ece" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%206.png"><img style="width:1907px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%206.png"/></a><figcaption><em>Figure 7 - HTTP GET requests</em></figcaption></figure><p id="4ab0da2d-65b9-4dc0-b11b-be58c28ab44c" class="">These are unencrypted HTTP GET request packet, next step in further analysis is to follow the stream and investigate the User-Agent field. </p><figure id="8ee1a895-8721-4886-9e59-304b7ef7eca0" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%207.png"><img style="width:708px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%207.png"/></a><figcaption><em>Figure 8 - HTTP Request showing possible powershell generated GET Request</em></figcaption></figure><p id="994f3e91-9f57-404f-9399-52bed4d1d533" class="">The presence of &quot;WindowsPowerShell&quot; in both User-Agent header strongly suggests that these HTTP GET requests were initiated by a PowerShell script. Here are the URLs for these requests:</p><ul id="7849ed34-228e-455c-b58a-9d25f4fc6415" class="bulleted-list"><li style="list-style-type:disc">http://623start.site/?status=start&amp;av=Windows%20Defender</li></ul><ul id="ab48a158-aefa-416f-ae3c-db8d1b506f49" class="bulleted-list"><li style="list-style-type:disc">http://623start.site/?status=install</li></ul><p id="d8dc198c-20a7-4482-b4be-9ad7b648914a" class="">Requests like these are common in web-based attacks or malicious activities. The domain <code>623start.site</code> could potentially be involved in phishing, malware distribution, or other illicit activities, this can be verified using Virus-Total in the image below.</p><figure id="3f2e4492-4d0b-4426-9210-e184d8c54cb2" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/8ff7bd0a-b995-45f6-b71e-aa79b8145852.png"><img style="width:708px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/8ff7bd0a-b995-45f6-b71e-aa79b8145852.png"/></a><figcaption><em>Figure 9 - Domain analysis using VirusTotal</em></figcaption></figure><p id="7149b039-d266-4bfb-ba1c-2b25f2a56391" class="">The final HTTP GET request without encryption is for <em><span style="border-bottom:0.05em solid">http://guiatelefonos.com/data/czx.jpg</span></em>. By following the TCP stream for this request, it becomes evident that the URL was redirected to its HTTPS counterpart, depicted in Figure 10.</p><figure id="6ffbd97f-085f-4b31-8384-d9b89c001643" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%208.png"><img style="width:708px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%208.png"/></a><figcaption><em>figure 10 - HTTP URL to guiatelefonos.com </em></figcaption></figure><p id="557b8295-550f-4439-85b1-e5cafa69cad1" class="">To probe for possible data exfiltration we can apply the filter: </p><p id="9340b7d6-765b-4da7-a824-12a13f83b244" class="">!(tcp.port eq 443) and !(tcp.port eq 80) and !(ip.dst eq 10.7.10.0/24)</p><p id="63ba51d8-87d4-4ea0-ac41-834e08da8a2c" class="">The Wireshark filter <code>!(tcp.port eq 443) and !(tcp.port eq 80) and !(ip.dst eq 10.7.10.0/24)</code> effectively excludes network traffic destined for HTTPS (port 443) and HTTP (port 80), as well as traffic within the specified local subnet (<code>10.7.10.0/24</code>).</p><figure id="7e221727-ac31-46bb-a5db-0dafda77b57c" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/353f5b42-1e30-49e1-b1e1-ca79b3f205ee.png"><img style="width:708px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/353f5b42-1e30-49e1-b1e1-ca79b3f205ee.png"/></a><figcaption><em>Figure 11a - following TCP Stream</em></figcaption></figure><p id="7b0faaa4-1f89-4876-92da-93a7638a1557" class=""><code>tcp://194.26.135.119:12432/</code>: Indicates RedLine stealer C2 server</p><p id="6372f087-bd74-46b1-ac74-84505896350c" class="">To gain deeper insight into the specific data that this RedLine Stealer sample is seeking, analyse the data transmitted from the server to the compromised Windows host, as illustrated in Figure 11b.</p><p id="e7c5e8c1-062a-4397-b75e-0d2de9d16c0b" class="">Data from the RedLine C2 server is requesting various types of user information from the victim’s host. Figure 11b highlights data this infection is looking for under the victim’s user profile.</p><figure id="3f9430dc-c35d-40f5-ad03-d6c9e45d0042" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%209.png"><img style="width:708px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%209.png"/></a><figcaption><em>Figure 11b - Viewing TCP data sent from C2 server to the infected Host as well as viewing the requested data from the victim’s host</em></figcaption></figure><p id="fd1b242b-9f22-4bec-953f-27a6b2db7af5" class="">The list encompasses wildcard searches within the victim&#x27;s desktop and documents folder, targeting text files, Word documents, and files related to cryptocurrency wallets, as depicted below:</p><ul id="c9b0c0ca-7917-44f0-b3ac-bd52de29525f" class="bulleted-list"><li style="list-style-type:disc"><code>%userprofile%\\Desktop|*.txt,*.doc*,*key*,*wallet*,*seed*|0</code></li></ul><ul id="e622bdaf-05da-4b0f-b3a4-b3caf1631206" class="bulleted-list"><li style="list-style-type:disc"><code>%userprofile%\\Documents|*.txt,*.doc*,*key*,*wallet*,*seed*|0</code></li></ul><p id="d7f70824-2f1b-4c65-bc53-cbd6aff9a8a4" class="">The list proceeds to specify data extracted from various applications, identified by their anticipated locations within the victim’s user profile&#x27;s AppData directory. The entries are presented below in alphabetical order:</p><ul id="949b82c7-7de5-46ca-9cad-df209e4758cf" class="bulleted-list"><li style="list-style-type:disc"><code>%USERPROFILE%\\AppData\\Local\\360Browser\\Browser\\User Data</code></li></ul><ul id="320a068c-1efa-4fe7-ab9f-7bd7e9a914d8" class="bulleted-list"><li style="list-style-type:disc"><code>%USERPROFILE%\\AppData\\Local\\7Star\\7Star\\User Data</code></li></ul><p id="1abadea5-0c45-46c9-a441-8a5ee1810f8a" class="">and lot more:</p><p id="fe928727-ea85-4313-9962-dd16dcee7f44" class="">This compilation comprises cloud platforms, social media apps, and miscellaneous tools. Presented below is an alphabetically organized list:</p><ul id="7f84eb7a-a0f8-4ad2-af21-c783d7a6c8a9" class="bulleted-list"><li style="list-style-type:disc">ALGOLIA_API_KEY</li></ul><ul id="cc778924-e374-4cbf-9596-1673a87f1573" class="bulleted-list"><li style="list-style-type:disc">AMAZON_AWS_ACCESS_KEY_ID</li></ul><p id="741531f1-78b9-4bf9-9d5e-4bdd3edfbb8a" class="">and lot more</p><p id="0901a3ad-3f26-42f3-a84a-849e94646e50" class="">Towards the conclusion of this TCP stream, we encounter a compilation of active processes, illustrated in Figure 12. Additionally, there is information retrieved from the compromised host, login credentials obtained from the Edge browser, and a file identified as <em><strong><span style="border-bottom:0.05em solid">Top_secret_document.docx.</span></strong></em></p><p id="0205f3e7-8894-486d-9a5a-d05eadaf8e88" class="">The list of running processes shown in Figure 17 includes an instance of powershell.exe executing a file located at C:\Users\rwalters\Documents\mystery_file.ps1. This .ps1 file is responsible for generating the infection traffic observed in this network packet.</p><figure id="0b7dc729-0463-4715-8810-2d2d17fa0d19" class="image"><a href="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%2010.png"><img style="width:708px" src="2023%20MALWARE%20LOADER%20--%20REDLINE%20STEALER%20cf44ab0c0d2e42fcada45fe9e00c55e5/Untitled%2010.png"/></a><figcaption><em>Figure 12 - Active processes, extracted login credentials, and a Word document were exfiltrated from the compromised Windows host.</em></figcaption></figure><p id="94e8296f-99e3-4bd9-976e-c67d18f100c1" class="">
</p><p id="f6efd665-ef6a-484e-85e4-047ef0850c1f" class="">
</p><p id="1f210932-585b-4c3e-9b86-b41f1f7f83a9" class="">
</p><p id="ecc157fe-f17f-425b-9dc1-91196e006659" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>